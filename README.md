
📊⚡💨🌡️⛅⚡📈🌍⛈️🌤️🌧️🌞🔥🌪️🌈⛈️🌟🌊🌤️🌡️🌬️🌩️🌻🌸🌿🌱🌾🌵🌲🌳🌴🌿🌲🌱🌿📊💻🤖🎯🚀📈🌐🔬👩‍🔬🧠📚🔥💯⚡🚀🎯🤖🎉🌟💫📊🔬🧬
👨‍💻🧑‍🔬🌊🌑💻👾⚡🎯🔥📈🌟🌈🌪️🌤️⛈️🌳🌲🌲🌳🌲🌿🌱🌿🌵🌾🌾💻🤖👩‍🔬🧠🔬🌈🎉🌟💫🔥🌟🌞🌞🌞🔥🔥🔥🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟
🔥🔥🔥🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🔥🔥🔥🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻
🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈
💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈
🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈
🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟
🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟
🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟
🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️
🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟
☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯
🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡
🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀
⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊
🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬
📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖
🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻
🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈
💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈
🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈
🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟
🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟
🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟
🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️
🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟
☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯
🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡
🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀
⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊
🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬
📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖
🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻
🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈
💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀⚡🎯🌟☔️🌟🌟🌟🌈🌈🌈💻🤖🔬📊🚀

# MeteoLibre Model

A Python library for weather forecasting using advanced diffusion models and deep learning. This project implements multiple generative approaches for meteorological data prediction and analysis.

## Features

🪐 **Multiple Diffusion Approaches:**
- **Blurring Diffusion**: Custom blurring-based diffusion process
- **Rectified Flow**: Efficient flow-based generative modeling
- **Score-Based Diffusion**: Traditional score-based generative models

🌋 **Advanced Neural Architectures:**
- **3D DC-AE U-Net**: Specialized for high-dimensional meteorological data
- **FiLM-conditioned models**: Feature-wise linear modulation
- **Optimized for meteorological data**: Designed for weather patterns and atmospheric science

⚡ **Optimized Training:**
- **Accelerate Integration**: Distributed training support
- **Mixed Precision Training**: Efficient GPU utilization
- **TensorBoard Logging**: Comprehensive training monitoring

📊 **Data Handling:**
- **MeteoLibre Dataset**: Specialized dataset for meteorological forecasting
- **Efficient Data Loading**: Parallel loading and preprocessing
- **HuggingFace Integration**: Easy dataset access and distribution

🧬 **Scientific Computing:**
- **PyTorch-based**: Full PyTorch ecosystem integration
- **Scientific libraries**: NumPy, SciPy, Torchvision support
- **GPU acceleration**: CUDA-optimized operations

## Installation

### Prerequisites
- Python 3.10+
- PyTorch 2.0+
- CUDA-compatible GPU (recommended)

### Basic Installation
```bash
pip install -e .
```

### Development Installation
```bash
# Install with development dependencies
pip install -e ".[dev]"

# Install CUDA-optimized PyTorch
pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu118
```

## Project Structure

```
meteolibre_model/
├── dataset/           # Data loading and preprocessing
├── models/           # Neural network architectures
│   ├── dc_3dunet.py       # 3D DC-AE U-Net
│   └── dc_3dunet_film.py # FiLM-conditioned 3D U-Net
├── diffusion/        # Diffusion model implementations
│   ├── blurring_diffusion.py
│   ├── rectified_flow.py
│   ├── score_based.py
│   └── utils.py
└── scripts/         # Training and inference scripts
```

## Usage

### Training a Model
```bash
# Train rectified flow model
python scripts/train_rectified_flow_accelerate.py

# Train score-based model
python scripts/train_score_based_accelerate.py

# Train blurring diffusion model
python scripts/train_accelerate.py
```

### Inference and Testing
```bash
# Run inference tests
python scripts/inference_testing.py

# Compute mean and standard deviation
python scripts/compute_mean_std.py
```

### Visualization
```python
# Visualize noise schedules
python scripts/visualize_noise_schedule.py

# Visualize noise effects
python scripts/visualize_noise_effect.py
```

## Model Architecture

### 3D DC-AE U-Net
```python
from meteolibre_model.models.dc_3dunet import UNet_DCAE_3D

# Create model with FiLM conditioning
model = UNet_DCAE_3D(
    in_channels=1,
    out_channels=1,
    features=[32, 64, 128, 256]
)

# Forward pass
output = model(input_tensor)
```

### Diffusion Models
```python
# Rectified Flow
from meteolibre_model.diffusion.rectified_flow import (
    logsnr_schedule_cosine,
    get_proper_noise
)

# Blurring Diffusion
from meteolibre_model.diffusion.blurring_diffusion import (
    get_blurring_diffusion_schedules_pt,
    trainer_step
)
```

## Dataset

### MeteoLibre Dataset
The project uses a specialized dataset format for meteorological data:

```python
from meteolibre_model.dataset.dataset import MeteoLibreMapDataset

# Create dataset
dataset = MeteoLibreMapDataset(
    localrepo="/path/to/data",
    cache_size=8,
    seed=42
)

# Create dataloader
dataloader = DataLoader(dataset, batch_size=128, shuffle=True)
```

## Testing

Run the comprehensive test suite:
```bash
# Run all tests
python -m unittest discover tests/

# Run specific test file
python -m unittest tests.models.test_dc_3dunet
```

## Key Dependencies

- `torch>=2.0` - Deep learning framework
- `accelerate` - Distributed training
- `datasets` - Data handling
- `scipy` - Scientific computing
- `matplotlib` - Visualization
- `einops` - Tensor operations

## Configuration

### Hyperparameters
```python
# Training configuration
batch_size = 128
learning_rate = 1e-4
num_epochs = 1000

# Model configuration
in_channels = 1
out_channels = 1
features = [32, 64, 128, 256]

# Diffusion parameters
noise_scale = 0.1
timesteps = 1000
```

## Contributing

1. Fork the repository
2. Create a feature branch (`git checkout -b feature/amazing-feature`)
3. Commit your changes (`git commit -m 'Add some amazing feature'`)
4. Push to the branch (`git push origin feature/amazing-feature`)
5. Open a Pull Request

### Development Note
Be sure to check our [CRUSH.md](CRUSH.md) for:
- Code style guidelines
- Build and test commands
- Development workflow

## License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

---

Built with ❤️ using PyTorch and modern deep learning practices for meteorological forecasting.</content>
<parameter name="file_path">README.md